"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[382],{9401:(E,f,c)=>{c.d(f,{y:()=>h});var o=c(6895),s=c(2465),g=c(3395),n=c(4650);function y(a,p){if(1&a&&(n.ynx(0),n.TgZ(1,"div")(2,"div"),n._UZ(3,"i"),n.qZA(),n.TgZ(4,"div",2)(5,"span",3),n._uU(6),n.qZA(),n.TgZ(7,"span",4),n._uU(8),n.qZA()()(),n.BQk()),2&a){const d=n.oxw();n.xp6(1),n.Gre("border-round-lg surface-100 w-max flex justify-content-center align-items-center font-semibold p-1 ",d.orderStatusCSSData.backgroundColor,""),n.xp6(1),n.Gre("flex h-2rem w-2rem border",d.orderStatusCSSData.color,"-500 border-1 mx-1 border-circle bg-white justify-content-center align-items-center"),n.xp6(1),n.MT6("pi ",d.orderStatusCSSData.icon,"  ",d.orderStatusCSSData.iconColor,""),n.xp6(3),n.hij(" ",d.orderStatusCSSData.orderStatus.name,""),n.xp6(2),n.hij(" ",d.orderStatusCSSData.orderStatus.administrativeDetails,"")}}function l(a,p){if(1&a&&(n.TgZ(0,"div"),n._UZ(1,"i"),n.TgZ(2,"span",5),n._uU(3),n.qZA()()),2&a){const d=n.oxw();n.Gre("border-round-lg surface-100 w-max flex justify-content-center font-semibold p-1 ",d.orderStatusCSSData.backgroundColor,""),n.xp6(1),n.MT6("pi ",d.orderStatusCSSData.icon," m-2 ",d.orderStatusCSSData.iconColor,""),n.xp6(2),n.hij(" ",d.showOnlyAdministrativeDetails?d.orderStatusCSSData.orderStatus.administrativeDetails:d.orderStatusCSSData.orderStatus.name,"")}}let h=(()=>{class a{constructor(){this.name="",this.showOnlyAdministrativeDetails=!1,this.showAdministrativeDetails=!1}ngOnInit(){this.orderStatus||(this.orderStatus=new s.i,this.orderStatus.name=this.name),this.orderStatusCSSData=new g.E(this.orderStatus)}}return a.\u0275fac=function(d){return new(d||a)},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-order-status"]],inputs:{orderStatus:"orderStatus",name:"name",showOnlyAdministrativeDetails:"showOnlyAdministrativeDetails",showAdministrativeDetails:"showAdministrativeDetails"},standalone:!0,features:[n.jDz],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["simpleTemplate",""],[1,"flex","flex-column","align-items-center","mx-4"],[1,"text-color"],[1,"text-color-secondary","text-sm","font-normal"],[1,"text-color","m-2"]],template:function(d,m){if(1&d&&(n.YNc(0,y,9,12,"ng-container",0),n.YNc(1,l,4,8,"ng-template",null,1,n.W1O)),2&d){const P=n.MAs(2);n.Q6J("ngIf",m.showAdministrativeDetails)("ngIfElse",P)}},dependencies:[o.ez,o.O5]}),a})()},8857:(E,f,c)=>{c.d(f,{n:()=>o});var o=(()=>{return(s=o||(o={}))[s.RequestedByClient=1]="RequestedByClient",s[s.Packed=7]="Packed",s[s.Shipping=9]="Shipping",s[s.ScheduledForShipment=8]="ScheduledForShipment",s[s.OnTheWayToTheSeller=20]="OnTheWayToTheSeller",s[s.IncomeOrderCompleted=19]="IncomeOrderCompleted",s[s.ReceivedByClient=16]="ReceivedByClient",s[s.OutForDelivery=15]="OutForDelivery",s[s.Deleted=13]="Deleted",s[s.Rejected=21]="Rejected",o;var s})()},3395:(E,f,c)=>{c.d(f,{E:()=>s});var o=c(8857);class s{constructor(n){switch(this.orderStatus=n,n.id){case o.n.RequestedByClient:this.icon="pi-file-import",this.color="";break;case o.n.Packed:this.icon="pi-box",this.color="-blue";break;case o.n.ScheduledForShipment:this.icon="pi-calendar",this.color="-blue";break;case o.n.Shipping:this.icon="pi-truck",this.color="-yellow";break;case o.n.ReceivedByClient:this.icon="pi-check-circle",this.color="-green";break;case o.n.Deleted:this.icon="pi-trash",this.color="-red";break;case o.n.Rejected:this.icon="pi-times-circle",this.color="-red";break;default:this.icon="pi-file-import",this.color="-primary"}this.backgroundColor=""==this.color?"surface-100":"bg"+this.color+"-100",this.iconColor="text"+this.color+"-500"}}},6854:(E,f,c)=>{c.d(f,{p:()=>T});var o=c(5861),s=c(3905),g=c(4004),n=c(8505),y=c(8857),l=c(4243),h=c(4650),a=c(3276),p=c(9268),d=c(5773),m=c(6460),P=c(805),C=c(2039);let T=(()=>{class I{constructor(e,r,t,i,u,_){this.productCashingService=e,this.apiService=r,this.storageService=t,this.productService=i,this.messageService=u,this.currenciesService=_,this.waitingForOrders=!1}cancelOrderingIncomeOrderProductsList(e){return(0,s.z)(this.apiService.cancelOrderingIncomeOrderProductsList(e).pipe((0,g.U)(r=>(r&&(this.currentIncomeOrder.incomeOrderProducts=this.currentIncomeOrder.incomeOrderProducts?.filter(t=>!e?.some(i=>i.id===t.id)),this.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"products successfuly canceled"})),r))))}recieveOrderProductByShippingCompany(e,r,t){var i=this;return(0,o.Z)(function*(){let u=r;if(!e.arrivedDate)return i.messageService.add({key:"homeToast",severity:"warn",summary:"Missing some fields",detail:"Please fill arrived date"}),null;if(null==u)return i.messageService.add({key:"homeToast",severity:"warn",summary:"Missing some fields",detail:"Please fill delivering coast"}),null;let _=JSON.stringify(e.incomeOrderProducts),S=0,D=0;e.incomeOrderProducts.filter(O=>!!O.receivedByBuyer&&(S+=O.productSelection.quantity,!0)).forEach(O=>{D=Math.round(u*O.productSelection.quantity/S*10)/10,O.deliveringCost=D,u-=D,S-=O.productSelection.quantity});let v=yield(0,s.z)(i.apiService.recieveOrderProductByShippingCompany(e,r,t));return v.id?(i.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived by shipping company"}),i.fetchProductDataOfIncomeOrderProducts(v.incomeOrderProducts),v.incomeOrderProducts.forEach(O=>{v.totalPrice||(v.totalPrice=0),v.totalPrice+=O.deliveringCost?O.deliveringCost:0,v.totalPrice+=O.price?O.price:0}),i.currentIncomeOrder=v,i.currentIncomeOrder):(e.incomeOrderProducts=JSON.parse(_),null)})()}recieveOrderProductByBuyer(e){var r=this;return(0,o.Z)(function*(){let t=yield(0,s.z)(r.apiService.recieveOrderProductByBuyer(e));return t&&(r.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived by buyer"}),e.forEach(i=>i.receivedByBuyer=!0)),t})()}recieveIncomeOrderBySeller(e,r){var t=this;return(0,o.Z)(function*(){let i;t.waitingForOrders=!0;try{i=yield(0,s.z)(t.apiService.recieveIncomeOrderBySeller(e,r)),i&&(t.onTheWayToTheSellerIncomeOrdersList.splice(t.onTheWayToTheSellerIncomeOrdersList.indexOf(e),1),t.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived by seller"}))}finally{t.waitingForOrders=!1}return i})()}fetchProductDataOfIncomeOrders(e){let r=[];e.forEach(t=>{t.incomeOrderProducts.forEach(i=>{i.product.id&&!r.includes(i.product.id)&&r.push(i.product.id)})}),(0,s.z)(this.productCashingService.preLoadProduct(r)).then(t=>{e.forEach(i=>{i.incomeOrderProducts.forEach(u=>{u.product=t.getObject(u.product.id),this.productService.productFillSelectionByIds(u.product,u.productSelection)})})})}fetchProductDataOfIncomeOrderProducts(e){let r=[];e.forEach(t=>{t.product.id&&!r.includes(t.product.id)&&r.push(t.product.id)}),(0,s.z)(this.productCashingService.preLoadProduct(r)).then(t=>{e.forEach(i=>{i.product=t.getObject(i.product.id),this.productService.productFillSelectionByIds(i.product,i.productSelection)})})}fetchProductDataOfOrderProducts(e){let r=[];e.forEach(t=>{t.product&&!r.includes(t.product.id)&&r.push(t.product.id)}),(0,s.z)(this.productCashingService.preLoadProduct(r)).then(t=>{e.forEach(i=>{i.product&&(i.product=t.getObject(i.product.id),this.productService.productFillSelectionByIds(i.product,i.productSelection))})})}fetchProductDataOfOrders(e){let r=[];e.forEach(t=>t.orderProducts?.forEach(i=>{i.product&&!r.includes(i.product.id)&&r.push(i.product.id)})),(0,s.z)(this.productCashingService.preLoadProduct(r)).then(t=>{e.forEach(i=>i.orderProducts?.forEach(u=>{u.product&&(u.product=t.getObject(u.product.id),this.productService.productFillSelectionByIds(u.product,u.productSelection))}))})}getOnTheWayToTheSellerIncomeOrdersList(){var e=this;return(0,o.Z)(function*(){return e.onTheWayToTheSellerIncomeOrdersList||(e.waitingForOrders=!0,e.onTheWayToTheSellerIncomeOrdersList=yield(0,s.z)(e.apiService.getIncomeOrderByOrderStatusId(y.n.OnTheWayToTheSeller).pipe((0,n.b)(r=>{e.onTheWayToTheSellerIncomeOrdersList=r,e.fetchProductDataOfIncomeOrders(r)}))),e.waitingForOrders=!1),e.onTheWayToTheSellerIncomeOrdersList})()}getPreviousIncomeOrdersList(){var e=this;return(0,o.Z)(function*(){return e.previousIncomeOrdersList||(e.waitingForOrders=!0,e.previousIncomeOrdersList=yield(0,s.z)(e.apiService.getIncomeOrderByOrderStatusId(y.n.IncomeOrderCompleted)),e.previousIncomeOrdersList&&e.fetchProductDataOfIncomeOrders(e.previousIncomeOrdersList),e.waitingForOrders=!1,setTimeout(()=>{e.previousIncomeOrdersList.forEach(r=>{r.incomeOrderProducts.forEach(t=>{r.shippingCoast&&(t.shippingCost=r.shippingCoast/r.incomeOrderProducts.length)})})},10)),e.previousIncomeOrdersList})()}getCurrentIncomeOrder(){var e=this;return(0,o.Z)(function*(){return e.currentIncomeOrder||(e.waitingForOrders=!0,e.currentIncomeOrder=yield(0,s.z)(e.apiService.getCurrentIncomeOrder()),e.currentIncomeOrder.incomeOrderProducts&&(e.fetchProductDataOfIncomeOrderProducts(e.currentIncomeOrder.incomeOrderProducts),e.currentIncomeOrder.incomeOrderProducts.forEach(function(){var r=(0,o.Z)(function*(t){e.currentIncomeOrder.totalPrice||(e.currentIncomeOrder.totalPrice=0),e.currentIncomeOrder.totalPrice+=t.deliveringCost?t.deliveringCost:0,e.currentIncomeOrder.totalPrice+=t.price?t.price:0});return function(t){return r.apply(this,arguments)}}())),e.waitingForOrders=!1),e.currentIncomeOrder})()}getRequestedOrderProductAsIncomeOrderProductsList(){var e=this;return(0,o.Z)(function*(){return e.waitingForOrders=!0,e.requestedOrderProductAsIncomeOrderProductsList||(e.requestedOrderProductAsIncomeOrderProductsList=yield(0,s.z)(e.apiService.getRequestedOrderProductAsIncomeOrderProductsList()),e.requestedOrderProductAsIncomeOrderProductsList&&e.fetchProductDataOfIncomeOrderProducts(e.requestedOrderProductAsIncomeOrderProductsList)),e.waitingForOrders=!1,e.requestedOrderProductAsIncomeOrderProductsList})()}editIncomeOrderProduct(e){var r=this;return(0,o.Z)(function*(){r.waitingForOrders=!0;let t=r.requestedOrderProductAsIncomeOrderProductsList?.indexOf(e),i=yield(0,s.z)(r.apiService.editIncomeOrderProduct(e));null!=t&&null!=t&&i.id&&i.id>1&&(r.requestedOrderProductAsIncomeOrderProductsList?.splice(t,1),r.currentIncomeOrder&&r.currentIncomeOrder.incomeOrderProducts&&(r.currentIncomeOrder.incomeOrderProducts.push(i),r.fetchProductDataOfIncomeOrderProducts([i]),r.currentIncomeOrder.totalPrice||(r.currentIncomeOrder.totalPrice=0),r.currentIncomeOrder.totalPrice+=i.deliveringCost?i.deliveringCost:0,r.currentIncomeOrder.totalPrice+=i.price?i.price:0)),r.waitingForOrders=!1})()}getAllOrders(){var e=this;return(0,o.Z)(function*(){e.waitingForOrders=!0,e.user=e.storageService.getLoginData();let r=e.user.userRole;return e.allOrders||(e.allOrders=yield(0,s.z)(e.apiService.getAllOrders()),e.fetchProductDataOfOrders(e.allOrders),e.allOrders.forEach(t=>{t.totalPriceInUSD=e.currenciesService.getPriceInUSD(t.payedPrice,t.currency),e.orderHandleNextOdreStatus(t,r)})),e.waitingForOrders=!1,e.allOrders})()}getStatusesList(){var e=this;return(0,o.Z)(function*(){return e.statues||(e.statues=yield(0,s.z)(e.apiService.getOrderStatusesList())),e.statues})()}getUserOrders(e=!1){var r=this;return(0,o.Z)(function*(){let t;return r.waitingForOrders=!0,r.user=r.storageService.getLoginData(),r.allUserOrders||(r.allUserOrders=yield(0,s.z)(r.apiService.getUserOrders()),r.fetchProductDataOfOrders(r.allUserOrders),r.allUserOrders.forEach(i=>{t=r.user.locations.find(u=>u.id==i.location.id),t&&(i.location=t)})),r.waitingForOrders=e,r.allUserOrders})()}getUserCommingOrders(){var e=this;return(0,o.Z)(function*(){if(e.commingUserOrders)return e.commingUserOrders;e.waitingForOrders=!0,e.user=e.storageService.getLoginData();let r,t=yield(0,s.z)(e.apiService.getCommingOrderByUserIdWithOrderStatusWorkflow());return e.fetchProductDataOfOrders(t),t.forEach(i=>{r=e.user.locations.find(u=>u.id==i.location.id),r&&(i.location=r)}),e.waitingForOrders=!1,e.commingUserOrders=t,t})()}editOrder(e){var r=this;return(0,o.Z)(function*(){({...e}).orderProducts=void 0,yield(0,s.z)(r.apiService.editOrder(e))})()}RecieveOrderByClient(e){var r=this;return(0,o.Z)(function*(){let t=yield(0,s.z)(r.apiService.RecieveOrderByClient(e));if(t){let i=r.commingUserOrders.findIndex(u=>u.id===e.id);r.commingUserOrders=[...r.commingUserOrders.splice(i,1)],r.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived, Thank You Dear"})}return t})()}orderChangeOrderStatus(e,r){var t=this;return(0,o.Z)(function*(){let i=yield(0,s.z)(t.apiService.changeOrderStatusForOrder(e,r));if(!i)return;t.orderHandleNextOdreStatus(i,t.user.userRole),i.person=e.person,i.location=e.location,i.orderProducts=e.orderProducts;let _=t.allOrders.findIndex(S=>S.id==e.id);t.allOrders[_]=i,t.allUserOrders&&(_=t.allUserOrders.findIndex(S=>S.id==e.id),t.allUserOrders[_]=i)})()}orderHandleNextOdreStatus(e,r){let t=[];e.orderStatus.nextOrderStatuses.forEach(i=>{(r==l.u.manager||r==i.permitedAccessRole)&&t.unshift(i.nextStatus)}),e.orderStatus.nextPermitedOrderStatuses=t}}return I.\u0275fac=function(e){return new(e||I)(h.LFG(a.p),h.LFG(p.s),h.LFG(d.V),h.LFG(m.s),h.LFG(P.ez),h.LFG(C.t))},I.\u0275prov=h.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})()},3054:(E,f,c)=>{c.d(f,{A:()=>y,g:()=>n});var o=c(4650),s=c(6895),g=c(433);let n=(()=>{class l{constructor(a,p,d,m){this.el=a,this.ngModel=p,this.control=d,this.cd=m,this.onResize=new o.vpe}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(a){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(a){this.autoResize&&this.resize(a)}onBlur(a){this.autoResize&&this.resize(a)}resize(a){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(a||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}}return l.\u0275fac=function(a){return new(a||l)(o.Y36(o.SBq),o.Y36(g.On,8),o.Y36(g.a5,8),o.Y36(o.sBO))},l.\u0275dir=o.lG2({type:l,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(a,p){1&a&&o.NdJ("input",function(m){return p.onInput(m)})("focus",function(m){return p.onFocus(m)})("blur",function(m){return p.onBlur(m)}),2&a&&o.ekj("p-filled",p.filled)("p-inputtextarea-resizable",p.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}}),l})(),y=(()=>{class l{}return l.\u0275fac=function(a){return new(a||l)},l.\u0275mod=o.oAB({type:l}),l.\u0275inj=o.cJS({imports:[s.ez]}),l})()}}]);