"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[433],{9401:(P,O,a)=>{a.d(O,{y:()=>v});var s=a(6895),o=a(2465),_=a(3395),n=a(4650);function I(c,f){if(1&c&&(n.ynx(0),n.TgZ(1,"div")(2,"div"),n._UZ(3,"i"),n.qZA(),n.TgZ(4,"div",2)(5,"span",3),n._uU(6),n.qZA(),n.TgZ(7,"span",4),n._uU(8),n.qZA()()(),n.BQk()),2&c){const d=n.oxw();n.xp6(1),n.Gre("border-round-lg surface-100 w-max flex justify-content-center align-items-center font-semibold p-1 ",d.orderStatusCSSData.backgroundColor,""),n.xp6(1),n.Gre("flex h-2rem w-2rem border",d.orderStatusCSSData.color,"-500 border-1 mx-1 border-circle bg-white justify-content-center align-items-center"),n.xp6(1),n.MT6("pi ",d.orderStatusCSSData.icon,"  ",d.orderStatusCSSData.iconColor,""),n.xp6(3),n.hij(" ",d.orderStatusCSSData.orderStatus.name,""),n.xp6(2),n.hij(" ",d.orderStatusCSSData.orderStatus.administrativeDetails,"")}}function l(c,f){if(1&c&&(n.TgZ(0,"div"),n._UZ(1,"i"),n.TgZ(2,"span",5),n._uU(3),n.qZA()()),2&c){const d=n.oxw();n.Gre("border-round-lg surface-100 w-max flex justify-content-center font-semibold p-1 ",d.orderStatusCSSData.backgroundColor,""),n.xp6(1),n.MT6("pi ",d.orderStatusCSSData.icon," m-2 ",d.orderStatusCSSData.iconColor,""),n.xp6(2),n.hij(" ",d.showOnlyAdministrativeDetails?d.orderStatusCSSData.orderStatus.administrativeDetails:d.orderStatusCSSData.orderStatus.name,"")}}let v=(()=>{class c{constructor(){this.name="",this.showOnlyAdministrativeDetails=!1,this.showAdministrativeDetails=!1}ngOnInit(){this.orderStatus||(this.orderStatus=new o.i,this.orderStatus.name=this.name),this.orderStatusCSSData=new _.E(this.orderStatus)}}return c.\u0275fac=function(d){return new(d||c)},c.\u0275cmp=n.Xpm({type:c,selectors:[["app-order-status"]],inputs:{orderStatus:"orderStatus",name:"name",showOnlyAdministrativeDetails:"showOnlyAdministrativeDetails",showAdministrativeDetails:"showAdministrativeDetails"},standalone:!0,features:[n.jDz],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["simpleTemplate",""],[1,"flex","flex-column","align-items-center","mx-4"],[1,"text-color"],[1,"text-color-secondary","text-sm","font-normal"],[1,"text-color","m-2"]],template:function(d,m){if(1&d&&(n.YNc(0,I,9,12,"ng-container",0),n.YNc(1,l,4,8,"ng-template",null,1,n.W1O)),2&d){const E=n.MAs(2);n.Q6J("ngIf",m.showAdministrativeDetails)("ngIfElse",E)}},dependencies:[s.ez,s.O5]}),c})()},8857:(P,O,a)=>{a.d(O,{n:()=>s});var s=(()=>{return(o=s||(s={}))[o.RequestedByClient=1]="RequestedByClient",o[o.Packed=7]="Packed",o[o.Shipping=9]="Shipping",o[o.ScheduledForShipment=8]="ScheduledForShipment",o[o.OnTheWayToTheSeller=20]="OnTheWayToTheSeller",o[o.IncomeOrderCompleted=19]="IncomeOrderCompleted",o[o.ReceivedByClient=16]="ReceivedByClient",o[o.OutForDelivery=15]="OutForDelivery",o[o.Deleted=13]="Deleted",o[o.Rejected=21]="Rejected",s;var o})()},3395:(P,O,a)=>{a.d(O,{E:()=>o});var s=a(8857);class o{constructor(n){switch(this.orderStatus=n,n.id){case s.n.RequestedByClient:this.icon="pi-file-import",this.color="";break;case s.n.Packed:this.icon="pi-box",this.color="-blue";break;case s.n.ScheduledForShipment:this.icon="pi-calendar",this.color="-blue";break;case s.n.Shipping:this.icon="pi-truck",this.color="-yellow";break;case s.n.ReceivedByClient:this.icon="pi-check-circle",this.color="-green";break;case s.n.Deleted:this.icon="pi-trash",this.color="-red";break;case s.n.Rejected:this.icon="pi-times-circle",this.color="-red";break;default:this.icon="pi-file-import",this.color="-primary"}this.backgroundColor=""==this.color?"surface-100":"bg"+this.color+"-100",this.iconColor="text"+this.color+"-500"}}},6854:(P,O,a)=>{a.d(O,{p:()=>E});var s=a(5861),o=a(3905),_=a(4004),n=a(8857),I=a(4243),l=a(4650),v=a(9268),c=a(5773),f=a(5583),d=a(805),m=a(2039);let E=(()=>{class y{constructor(e,r,t,i,u){this.apiService=e,this.storageService=r,this.productService=t,this.messageService=i,this.currenciesService=u,this.waitingForOrders=!1}cancelOrderingIncomeOrderProductsList(e){return(0,o.z)(this.apiService.cancelOrderingIncomeOrderProductsList(e).pipe((0,_.U)(r=>(r&&(this.currentIncomeOrder.incomeOrderProducts=this.currentIncomeOrder.incomeOrderProducts?.filter(t=>!e?.some(i=>i.id===t.id)),this.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"products successfuly canceled"})),r))))}recieveOrderProductByShippingCompany(e,r,t){var i=this;return(0,s.Z)(function*(){let u=r;if(!e.arrivedDate)return i.messageService.add({key:"homeToast",severity:"warn",summary:"Missing some fields",detail:"Please fill arrived date"}),null;if(null==u)return i.messageService.add({key:"homeToast",severity:"warn",summary:"Missing some fields",detail:"Please fill delivering coast"}),null;let h=JSON.stringify(e.incomeOrderProducts),g=0,D=0;e.incomeOrderProducts.filter(p=>!!p.receivedByBuyer&&(g+=p.productSelection.quantity,!0)).forEach(p=>{D=Math.round(u*p.productSelection.quantity/g*10)/10,p.deliveringCost=D,u-=D,g-=p.productSelection.quantity});let S=yield(0,o.z)(i.apiService.recieveOrderProductByShippingCompany(e,r,t));return S.id?(i.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived by shipping company"}),S.incomeOrderProducts.forEach(p=>{i.fetchProductDataOfIncomeOrderProduct(p),S.totalPrice||(S.totalPrice=0),S.totalPrice+=p.deliveringCost?p.deliveringCost:0,S.totalPrice+=p.price?p.price:0}),i.currentIncomeOrder=S,i.currentIncomeOrder):(e.incomeOrderProducts=JSON.parse(h),null)})()}recieveOrderProductByBuyer(e){var r=this;return(0,s.Z)(function*(){let t=yield(0,o.z)(r.apiService.recieveOrderProductByBuyer(e));return t&&(r.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived by buyer"}),e.forEach(i=>i.receivedByBuyer=!0)),t})()}recieveIncomeOrderBySeller(e,r){var t=this;return(0,s.Z)(function*(){let i;t.waitingForOrders=!0;try{i=yield(0,o.z)(t.apiService.recieveIncomeOrderBySeller(e,r)),i&&(t.onTheWayToTheSellerIncomeOrdersList.splice(t.onTheWayToTheSellerIncomeOrdersList.indexOf(e),1),t.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived by seller"}))}finally{t.waitingForOrders=!1}return i})()}fetchProductDataOfIncomeOrderProduct(e){var r=this;return(0,s.Z)(function*(){let t;e.product&&(t=yield r.productService.getProductById(e.product.id)),t&&(e.product=t,r.productService.productFillSelectionByIds(e.product,e.productSelection))})()}getOnTheWayToTheSellerIncomeOrdersList(){var e=this;return(0,s.Z)(function*(){return e.onTheWayToTheSellerIncomeOrdersList||(e.waitingForOrders=!0,e.onTheWayToTheSellerIncomeOrdersList=yield(0,o.z)(e.apiService.getIncomeOrderByOrderStatusId(n.n.OnTheWayToTheSeller)),e.onTheWayToTheSellerIncomeOrdersList&&e.onTheWayToTheSellerIncomeOrdersList.forEach(r=>{r.incomeOrderProducts&&r.incomeOrderProducts.forEach(function(){var t=(0,s.Z)(function*(i){e.fetchProductDataOfIncomeOrderProduct(i)});return function(i){return t.apply(this,arguments)}}())}),e.waitingForOrders=!1),e.onTheWayToTheSellerIncomeOrdersList})()}getPreviousIncomeOrdersList(){var e=this;return(0,s.Z)(function*(){return e.previousIncomeOrdersList||(e.waitingForOrders=!0,e.previousIncomeOrdersList=yield(0,o.z)(e.apiService.getIncomeOrderByOrderStatusId(n.n.IncomeOrderCompleted)),e.previousIncomeOrdersList&&e.previousIncomeOrdersList.forEach(r=>{r.incomeOrderProducts&&r.incomeOrderProducts.forEach(function(){var t=(0,s.Z)(function*(i){e.fetchProductDataOfIncomeOrderProduct(i)});return function(i){return t.apply(this,arguments)}}())}),e.waitingForOrders=!1,setTimeout(()=>{e.previousIncomeOrdersList.forEach(r=>{r.incomeOrderProducts.forEach(t=>{r.shippingCoast&&(t.shippingCost=r.shippingCoast/r.incomeOrderProducts.length)})})},500)),e.previousIncomeOrdersList})()}getCurrentIncomeOrder(){var e=this;return(0,s.Z)(function*(){return e.currentIncomeOrder||(e.waitingForOrders=!0,e.currentIncomeOrder=yield(0,o.z)(e.apiService.getCurrentIncomeOrder()),e.currentIncomeOrder.incomeOrderProducts&&e.currentIncomeOrder.incomeOrderProducts.forEach(function(){var r=(0,s.Z)(function*(t){e.fetchProductDataOfIncomeOrderProduct(t),e.currentIncomeOrder.totalPrice||(e.currentIncomeOrder.totalPrice=0),e.currentIncomeOrder.totalPrice+=t.deliveringCost?t.deliveringCost:0,e.currentIncomeOrder.totalPrice+=t.price?t.price:0});return function(t){return r.apply(this,arguments)}}()),e.waitingForOrders=!1),e.currentIncomeOrder})()}getRequestedOrderProductAsIncomeOrderProductsList(){var e=this;return(0,s.Z)(function*(){return e.waitingForOrders=!0,e.requestedOrderProductAsIncomeOrderProductsList||(e.requestedOrderProductAsIncomeOrderProductsList=yield(0,o.z)(e.apiService.getRequestedOrderProductAsIncomeOrderProductsList()),e.requestedOrderProductAsIncomeOrderProductsList.forEach(function(){var r=(0,s.Z)(function*(t){e.fetchProductDataOfIncomeOrderProduct(t)});return function(t){return r.apply(this,arguments)}}())),e.waitingForOrders=!1,e.requestedOrderProductAsIncomeOrderProductsList})()}editIncomeOrderProduct(e){var r=this;return(0,s.Z)(function*(){r.waitingForOrders=!0;let t=r.requestedOrderProductAsIncomeOrderProductsList?.indexOf(e),i=yield(0,o.z)(r.apiService.editIncomeOrderProduct(e));null!=t&&null!=t&&i.id&&i.id>1&&(r.requestedOrderProductAsIncomeOrderProductsList?.splice(t,1),r.currentIncomeOrder&&r.currentIncomeOrder.incomeOrderProducts&&(r.currentIncomeOrder.incomeOrderProducts.push(i),r.fetchProductDataOfIncomeOrderProduct(i),r.currentIncomeOrder.totalPrice||(r.currentIncomeOrder.totalPrice=0),r.currentIncomeOrder.totalPrice+=i.deliveringCost?i.deliveringCost:0,r.currentIncomeOrder.totalPrice+=i.price?i.price:0)),r.waitingForOrders=!1})()}getAllOrders(){var e=this;return(0,s.Z)(function*(){e.waitingForOrders=!0,e.user=e.storageService.getLoginData();let r=e.user.userRole;return e.allOrders||(e.allOrders=yield(0,o.z)(e.apiService.getAllOrders()),e.allOrders.forEach(t=>{t.totalPriceInUSD=e.currenciesService.getPriceInUSD(t.payedPrice,t.currency),t.orderProducts&&t.orderProducts.forEach(function(){var i=(0,s.Z)(function*(u){u.product&&(u.product=yield e.productService.getProductById(u.product.id)),u.product&&e.productService.productFillSelectionByIds(u.product,u.productSelection)});return function(u){return i.apply(this,arguments)}}()),e.orderHandleNextOdreStatus(t,r)})),e.waitingForOrders=!1,e.allOrders})()}getStatusesList(){var e=this;return(0,s.Z)(function*(){return e.statues||(e.statues=yield(0,o.z)(e.apiService.getOrderStatusesList())),e.statues})()}getUserOrders(e=!1){var r=this;return(0,s.Z)(function*(){let t;return r.waitingForOrders=!0,r.user=r.storageService.getLoginData(),r.allUserOrders||(r.allUserOrders=yield(0,o.z)(r.apiService.getUserOrders()),r.allUserOrders.forEach(i=>{t=r.user.locations.find(u=>u.id==i.location.id),t&&(i.location=t),i.orderProducts&&i.orderProducts.forEach(function(){var u=(0,s.Z)(function*(h){h.product&&(h.product=yield r.productService.getProductById(h.product.id)),h.product&&r.productService.productFillSelectionByIds(h.product,h.productSelection)});return function(h){return u.apply(this,arguments)}}())})),r.waitingForOrders=e,r.allUserOrders})()}getUserCommingOrders(){var e=this;return(0,s.Z)(function*(){if(e.commingUserOrders)return e.commingUserOrders;e.waitingForOrders=!0,e.user=e.storageService.getLoginData();let r,t=yield(0,o.z)(e.apiService.getCommingOrderByUserIdWithOrderStatusWorkflow());return t.forEach(i=>{r=e.user.locations.find(u=>u.id==i.location.id),r&&(i.location=r),i.orderProducts&&i.orderProducts.forEach(function(){var u=(0,s.Z)(function*(h){h.product&&(h.product=yield e.productService.getProductById(h.product.id)),h.product&&e.productService.productFillSelectionByIds(h.product,h.productSelection)});return function(h){return u.apply(this,arguments)}}())}),e.waitingForOrders=!1,e.commingUserOrders=t,t})()}editOrder(e){var r=this;return(0,s.Z)(function*(){({...e}).orderProducts=void 0,yield(0,o.z)(r.apiService.editOrder(e))})()}RecieveOrderByClient(e){var r=this;return(0,s.Z)(function*(){let t=yield(0,o.z)(r.apiService.RecieveOrderByClient(e));if(t){let i=r.commingUserOrders.findIndex(u=>u.id===e.id);r.commingUserOrders=[...r.commingUserOrders.splice(i,1)],r.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived, Thank You Dear"})}return t})()}orderChangeOrderStatus(e,r){var t=this;return(0,s.Z)(function*(){let i=yield(0,o.z)(t.apiService.changeOrderStatusForOrder(e,r));if(!i)return;t.orderHandleNextOdreStatus(i,t.user.userRole),i.person=e.person,i.location=e.location,i.orderProducts=e.orderProducts;let h=t.allOrders.findIndex(g=>g.id==e.id);t.allOrders[h]=i,t.allUserOrders&&(h=t.allUserOrders.findIndex(g=>g.id==e.id),t.allUserOrders[h]=i)})()}orderHandleNextOdreStatus(e,r){let t=[];e.orderStatus.nextOrderStatuses.forEach(i=>{(r==I.u.manager||r==i.permitedAccessRole)&&t.unshift(i.nextStatus)}),e.orderStatus.nextPermitedOrderStatuses=t}}return y.\u0275fac=function(e){return new(e||y)(l.LFG(v.s),l.LFG(c.V),l.LFG(f.s),l.LFG(d.ez),l.LFG(m.t))},y.\u0275prov=l.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()},3054:(P,O,a)=>{a.d(O,{A:()=>I,g:()=>n});var s=a(4650),o=a(6895),_=a(433);let n=(()=>{class l{constructor(c,f,d,m){this.el=c,this.ngModel=f,this.control=d,this.cd=m,this.onResize=new s.vpe}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(c){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(c){this.autoResize&&this.resize(c)}onBlur(c){this.autoResize&&this.resize(c)}resize(c){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(c||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}}return l.\u0275fac=function(c){return new(c||l)(s.Y36(s.SBq),s.Y36(_.On,8),s.Y36(_.a5,8),s.Y36(s.sBO))},l.\u0275dir=s.lG2({type:l,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(c,f){1&c&&s.NdJ("input",function(m){return f.onInput(m)})("focus",function(m){return f.onFocus(m)})("blur",function(m){return f.onBlur(m)}),2&c&&s.ekj("p-filled",f.filled)("p-inputtextarea-resizable",f.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}}),l})(),I=(()=>{class l{}return l.\u0275fac=function(c){return new(c||l)},l.\u0275mod=s.oAB({type:l}),l.\u0275inj=s.cJS({imports:[o.ez]}),l})()}}]);