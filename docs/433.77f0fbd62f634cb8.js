"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[433],{9401:(P,p,o)=>{o.d(p,{y:()=>I});var s=o(6895),n=o(2465),v=o(3395),l=o(4650);let I=(()=>{class c{constructor(){this.name="",this.showAdministrativeDetails=!1}ngOnInit(){this.orderStatus||(this.orderStatus=new n.i,this.orderStatus.name=this.name),this.orderStatusCSSData=new v.E(this.orderStatus)}}return c.\u0275fac=function(u){return new(u||c)},c.\u0275cmp=l.Xpm({type:c,selectors:[["app-order-status"]],inputs:{orderStatus:"orderStatus",name:"name",showAdministrativeDetails:"showAdministrativeDetails"},standalone:!0,features:[l.jDz],decls:4,vars:8,consts:[[1,"text-color","m-2"]],template:function(u,h){1&u&&(l.TgZ(0,"div"),l._UZ(1,"i"),l.TgZ(2,"span",0),l._uU(3),l.qZA()()),2&u&&(l.Gre("border-round-lg surface-100 w-max flex justify-content-center font-semibold p-1 ",h.orderStatusCSSData.backgroundColor,""),l.xp6(1),l.MT6("pi ",h.orderStatusCSSData.icon," m-2 ",h.orderStatusCSSData.iconColor,""),l.xp6(2),l.hij(" ",h.showAdministrativeDetails?h.orderStatusCSSData.orderStatus.administrativeDetails:h.orderStatusCSSData.orderStatus.name,""))},dependencies:[s.ez]}),c})()},8857:(P,p,o)=>{o.d(p,{n:()=>s});var s=(()=>{return(n=s||(s={}))[n.RequestedByClient=1]="RequestedByClient",n[n.Packed=7]="Packed",n[n.Shipping=9]="Shipping",n[n.ScheduledForShipment=8]="ScheduledForShipment",n[n.OnTheWayToTheSeller=20]="OnTheWayToTheSeller",n[n.IncomeOrderCompleted=19]="IncomeOrderCompleted",n[n.ReceivedByClient=16]="ReceivedByClient",n[n.OutForDelivery=15]="OutForDelivery",n[n.Deleted=13]="Deleted",n[n.Rejected=21]="Rejected",s;var n})()},3395:(P,p,o)=>{o.d(p,{E:()=>n});var s=o(8857);class n{constructor(l){switch(this.orderStatus=l,l.id){case s.n.RequestedByClient:this.icon="pi-file-import",this.color="";break;case s.n.Packed:this.icon="pi-box",this.color="-blue";break;case s.n.ScheduledForShipment:this.icon="pi-calendar",this.color="-blue";break;case s.n.Shipping:this.icon="pi-truck",this.color="-yellow";break;case s.n.ReceivedByClient:this.icon="pi-check-circle",this.color="-green";break;case s.n.Deleted:this.icon="pi-trash",this.color="-red";break;case s.n.Rejected:this.icon="pi-times-circle",this.color="-red";break;default:this.icon="pi-file-import",this.color="-primary"}this.backgroundColor=""==this.color?"surface-100":"bg"+this.color+"-100",this.iconColor="text"+this.color+"-500"}}},6854:(P,p,o)=>{o.d(p,{p:()=>D});var s=o(5861),n=o(3905),v=o(4004),l=o(8857),I=o(4243),c=o(4650),m=o(9268),u=o(5773),h=o(5583),S=o(805),O=o(2039);let D=(()=>{class y{constructor(e,r,t,i,a){this.apiService=e,this.storageService=r,this.productService=t,this.messageService=i,this.currenciesService=a,this.waitingForOrders=!1}cancelOrderingIncomeOrderProductsList(e){return(0,n.z)(this.apiService.cancelOrderingIncomeOrderProductsList(e).pipe((0,v.U)(r=>(r&&(this.currentIncomeOrder.incomeOrderProducts=this.currentIncomeOrder.incomeOrderProducts?.filter(t=>!e?.some(i=>i.id===t.id)),this.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"products successfuly canceled"})),r))))}recieveOrderProductByShippingCompany(e,r,t){var i=this;return(0,s.Z)(function*(){let a=r;if(!e.arrivedDate)return i.messageService.add({key:"homeToast",severity:"warn",summary:"Missing some fields",detail:"Please fill arrived date"}),null;if(null==a)return i.messageService.add({key:"homeToast",severity:"warn",summary:"Missing some fields",detail:"Please fill delivering coast"}),null;let d=JSON.stringify(e.incomeOrderProducts),_=0,E=0;e.incomeOrderProducts.filter(f=>!!f.receivedByBuyer&&(_+=f.productSelection.quantity,!0)).forEach(f=>{E=Math.round(a*f.productSelection.quantity/_*10)/10,f.deliveringCost=E,a-=E,_-=f.productSelection.quantity});let g=yield(0,n.z)(i.apiService.recieveOrderProductByShippingCompany(e,r,t));return g.id?(i.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived by shipping company"}),g.incomeOrderProducts.forEach(f=>{i.fetchProductDataOfIncomeOrderProduct(f),g.totalPrice||(g.totalPrice=0),g.totalPrice+=f.deliveringCost?f.deliveringCost:0,g.totalPrice+=f.price?f.price:0}),i.currentIncomeOrder=g,i.currentIncomeOrder):(e.incomeOrderProducts=JSON.parse(d),null)})()}recieveOrderProductByBuyer(e){var r=this;return(0,s.Z)(function*(){let t=yield(0,n.z)(r.apiService.recieveOrderProductByBuyer(e));return t&&(r.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived by buyer"}),e.forEach(i=>i.receivedByBuyer=!0)),t})()}recieveIncomeOrderBySeller(e,r){var t=this;return(0,s.Z)(function*(){let i;t.waitingForOrders=!0;try{i=yield(0,n.z)(t.apiService.recieveIncomeOrderBySeller(e,r)),i&&(t.onTheWayToTheSellerIncomeOrdersList.splice(t.onTheWayToTheSellerIncomeOrdersList.indexOf(e),1),t.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived by seller"}))}finally{t.waitingForOrders=!1}return i})()}fetchProductDataOfIncomeOrderProduct(e){var r=this;return(0,s.Z)(function*(){let t;e.product&&(t=yield r.productService.getProductById(e.product.id)),t&&(e.product=t,r.productService.productFillSelectionByIds(e.product,e.productSelection))})()}getOnTheWayToTheSellerIncomeOrdersList(){var e=this;return(0,s.Z)(function*(){return e.onTheWayToTheSellerIncomeOrdersList||(e.waitingForOrders=!0,e.onTheWayToTheSellerIncomeOrdersList=yield(0,n.z)(e.apiService.getIncomeOrderByOrderStatusId(l.n.OnTheWayToTheSeller)),e.onTheWayToTheSellerIncomeOrdersList&&e.onTheWayToTheSellerIncomeOrdersList.forEach(r=>{r.incomeOrderProducts&&r.incomeOrderProducts.forEach(function(){var t=(0,s.Z)(function*(i){e.fetchProductDataOfIncomeOrderProduct(i)});return function(i){return t.apply(this,arguments)}}())}),e.waitingForOrders=!1),e.onTheWayToTheSellerIncomeOrdersList})()}getPreviousIncomeOrdersList(){var e=this;return(0,s.Z)(function*(){return e.previousIncomeOrdersList||(e.waitingForOrders=!0,e.previousIncomeOrdersList=yield(0,n.z)(e.apiService.getIncomeOrderByOrderStatusId(l.n.IncomeOrderCompleted)),e.previousIncomeOrdersList&&e.previousIncomeOrdersList.forEach(r=>{r.incomeOrderProducts&&r.incomeOrderProducts.forEach(function(){var t=(0,s.Z)(function*(i){e.fetchProductDataOfIncomeOrderProduct(i)});return function(i){return t.apply(this,arguments)}}())}),e.waitingForOrders=!1,setTimeout(()=>{e.previousIncomeOrdersList.forEach(r=>{r.incomeOrderProducts.forEach(t=>{r.shippingCoast&&(t.shippingCost=r.shippingCoast/r.incomeOrderProducts.length)})})},500)),e.previousIncomeOrdersList})()}getCurrentIncomeOrder(){var e=this;return(0,s.Z)(function*(){return e.currentIncomeOrder||(e.waitingForOrders=!0,e.currentIncomeOrder=yield(0,n.z)(e.apiService.getCurrentIncomeOrder()),e.currentIncomeOrder.incomeOrderProducts&&e.currentIncomeOrder.incomeOrderProducts.forEach(function(){var r=(0,s.Z)(function*(t){e.fetchProductDataOfIncomeOrderProduct(t),e.currentIncomeOrder.totalPrice||(e.currentIncomeOrder.totalPrice=0),e.currentIncomeOrder.totalPrice+=t.deliveringCost?t.deliveringCost:0,e.currentIncomeOrder.totalPrice+=t.price?t.price:0});return function(t){return r.apply(this,arguments)}}()),e.waitingForOrders=!1),e.currentIncomeOrder})()}getRequestedOrderProductAsIncomeOrderProductsList(){var e=this;return(0,s.Z)(function*(){return e.waitingForOrders=!0,e.requestedOrderProductAsIncomeOrderProductsList||(e.requestedOrderProductAsIncomeOrderProductsList=yield(0,n.z)(e.apiService.getRequestedOrderProductAsIncomeOrderProductsList()),e.requestedOrderProductAsIncomeOrderProductsList.forEach(function(){var r=(0,s.Z)(function*(t){e.fetchProductDataOfIncomeOrderProduct(t)});return function(t){return r.apply(this,arguments)}}())),e.waitingForOrders=!1,e.requestedOrderProductAsIncomeOrderProductsList})()}editIncomeOrderProduct(e){var r=this;return(0,s.Z)(function*(){r.waitingForOrders=!0;let t=r.requestedOrderProductAsIncomeOrderProductsList?.indexOf(e),i=yield(0,n.z)(r.apiService.editIncomeOrderProduct(e));null!=t&&null!=t&&i.id&&i.id>1&&(r.requestedOrderProductAsIncomeOrderProductsList?.splice(t,1),r.currentIncomeOrder&&r.currentIncomeOrder.incomeOrderProducts&&(r.currentIncomeOrder.incomeOrderProducts.push(i),r.fetchProductDataOfIncomeOrderProduct(i),r.currentIncomeOrder.totalPrice||(r.currentIncomeOrder.totalPrice=0),r.currentIncomeOrder.totalPrice+=i.deliveringCost?i.deliveringCost:0,r.currentIncomeOrder.totalPrice+=i.price?i.price:0)),r.waitingForOrders=!1})()}getAllOrders(){var e=this;return(0,s.Z)(function*(){e.waitingForOrders=!0,e.user=e.storageService.getLoginData();let r=e.user.userRole;return e.allOrders||(e.allOrders=yield(0,n.z)(e.apiService.getAllOrders()),e.allOrders.forEach(t=>{t.totalPriceInUSD=e.currenciesService.getPriceInUSD(t.payedPrice,t.currency),t.orderProducts&&t.orderProducts.forEach(function(){var i=(0,s.Z)(function*(a){a.product&&(a.product=yield e.productService.getProductById(a.product.id)),a.product&&e.productService.productFillSelectionByIds(a.product,a.productSelection)});return function(a){return i.apply(this,arguments)}}()),e.orderHandleNextOdreStatus(t,r)})),e.waitingForOrders=!1,e.allOrders})()}getStatusesList(){var e=this;return(0,s.Z)(function*(){return e.statues||(e.statues=yield(0,n.z)(e.apiService.getOrderStatusesList())),e.statues})()}getUserOrders(e=!1){var r=this;return(0,s.Z)(function*(){let t;return r.waitingForOrders=!0,r.user=r.storageService.getLoginData(),r.allUserOrders||(r.allUserOrders=yield(0,n.z)(r.apiService.getUserOrders()),r.allUserOrders.forEach(i=>{t=r.user.locations.find(a=>a.id==i.location.id),t&&(i.location=t),i.orderProducts&&i.orderProducts.forEach(function(){var a=(0,s.Z)(function*(d){d.product&&(d.product=yield r.productService.getProductById(d.product.id)),d.product&&r.productService.productFillSelectionByIds(d.product,d.productSelection)});return function(d){return a.apply(this,arguments)}}())})),r.waitingForOrders=e,r.allUserOrders})()}getUserCommingOrders(){var e=this;return(0,s.Z)(function*(){if(e.commingUserOrders)return e.commingUserOrders;e.waitingForOrders=!0,e.user=e.storageService.getLoginData();let r,t=yield(0,n.z)(e.apiService.getCommingOrderByUserIdWithOrderStatusWorkflow());return t.forEach(i=>{r=e.user.locations.find(a=>a.id==i.location.id),r&&(i.location=r),i.orderProducts&&i.orderProducts.forEach(function(){var a=(0,s.Z)(function*(d){d.product&&(d.product=yield e.productService.getProductById(d.product.id)),d.product&&e.productService.productFillSelectionByIds(d.product,d.productSelection)});return function(d){return a.apply(this,arguments)}}())}),e.waitingForOrders=!1,e.commingUserOrders=t,t})()}editOrder(e){var r=this;return(0,s.Z)(function*(){({...e}).orderProducts=void 0,yield(0,n.z)(r.apiService.editOrder(e))})()}RecieveOrderByClient(e){var r=this;return(0,s.Z)(function*(){let t=yield(0,n.z)(r.apiService.RecieveOrderByClient(e));if(t){let i=r.commingUserOrders.findIndex(a=>a.id===e.id);r.commingUserOrders=[...r.commingUserOrders.splice(i,1)],r.messageService.add({key:"homeToast",severity:"success",summary:"Success",detail:"order successfuly recived, Thank You Dear"})}return t})()}orderChangeOrderStatus(e,r){var t=this;return(0,s.Z)(function*(){let i=yield(0,n.z)(t.apiService.changeOrderStatusForOrder(e,r));if(!i)return;t.orderHandleNextOdreStatus(i,t.user.userRole),i.person=e.person,i.location=e.location,i.orderProducts=e.orderProducts;let d=t.allOrders.findIndex(_=>_.id==e.id);t.allOrders[d]=i,t.allUserOrders&&(d=t.allUserOrders.findIndex(_=>_.id==e.id),t.allUserOrders[d]=i)})()}orderHandleNextOdreStatus(e,r){let t=[];e.orderStatus.nextOrderStatuses.forEach(i=>{(r==I.u.manager||r==i.permitedAccessRole)&&t.unshift(i.nextStatus)}),e.orderStatus.nextPermitedOrderStatuses=t}}return y.\u0275fac=function(e){return new(e||y)(c.LFG(m.s),c.LFG(u.V),c.LFG(h.s),c.LFG(S.ez),c.LFG(O.t))},y.\u0275prov=c.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()},3054:(P,p,o)=>{o.d(p,{A:()=>I,g:()=>l});var s=o(4650),n=o(6895),v=o(433);let l=(()=>{class c{constructor(u,h,S,O){this.el=u,this.ngModel=h,this.control=S,this.cd=O,this.onResize=new s.vpe}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(u){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(u){this.autoResize&&this.resize(u)}onBlur(u){this.autoResize&&this.resize(u)}resize(u){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(u||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}}return c.\u0275fac=function(u){return new(u||c)(s.Y36(s.SBq),s.Y36(v.On,8),s.Y36(v.a5,8),s.Y36(s.sBO))},c.\u0275dir=s.lG2({type:c,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(u,h){1&u&&s.NdJ("input",function(O){return h.onInput(O)})("focus",function(O){return h.onFocus(O)})("blur",function(O){return h.onBlur(O)}),2&u&&s.ekj("p-filled",h.filled)("p-inputtextarea-resizable",h.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}}),c})(),I=(()=>{class c{}return c.\u0275fac=function(u){return new(u||c)},c.\u0275mod=s.oAB({type:c}),c.\u0275inj=s.cJS({imports:[n.ez]}),c})()}}]);